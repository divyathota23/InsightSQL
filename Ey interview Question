Question - You have the following two tables:

 Transactions:
 transaction_id (INT)
 customer_id (INT)
 transaction_date (DATE)
 amount (DECIMAL)

 Customers:
 customer_id (INT)
 customer_name (VARCHAR)

Write a SQL query to find the average transaction amount for each customer who made more than 5 transactions in September 2023.


solution:
SELECT c.customer_name, 
       AVG(t.amount) AS average_transaction
FROM Customers c
JOIN Transactions t ON c.customer_id = t.customer_id
WHERE c.customer_id IN (
    SELECT customer_id
    FROM Transactions
    WHERE transaction_date BETWEEN '2023-09-01' AND '2023-09-30'
    GROUP BY customer_id
    HAVING COUNT(transaction_id) > 5
)
GROUP BY c.customer_name;

